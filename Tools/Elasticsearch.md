## 场景数据
1. 每个item具有各类label,e.g.曲风、情绪、语言、年代、地区、歌手类型……

2. 在各类标签的内部，具有系列标签集合，e.g. 曲风 - set（l1, l2, l3, ……）

3. 对于某个item的某类label，有该item在各个具体标签上的得分，e.g. 曲风 - l1:0.65#l2:0.25#l3:0.1

4. 具体tag之间，还具有相似度数据：e.g. l1-l2:0.95, l1-l3:0.33 ……

5. item可供加权、筛选的其他数据，e.g. 热度、……

## 输入输出
1. 输入：查询的item，包括各类label特征

2. 计算逻辑：

      根据各类型中的主标签相似度显式地筛选候选集（？是否有能力）
      
      相关性计算、排序
      
      其他业务逻辑的加权、筛选
      
3. 输出：根据item的各label特征之间的匹配程度，按相关性得分计算的结果

## 标签相关性：
1. label类型之间的权重：各类label的相关性对于整体item的相关性，必须可指定

2. label类型内部的具体标签权重：

  a）有机会通过ES索引构建时的正、倒排数据，基于TF-IDF或BM25计算出相关性（根据分布获取的客观性打分，损失在于：1.标签本身的偏差；2.模型能力偏差）
  
    ① TF-IDF：
    
      TF: 词语在文档内的频次，对应此处的内部相对贡献
      
          若舍弃score，把标签作为文档“l1 l2 l3”，则丢失了频率信息（TF）- 考虑可根据得分还原为频次数据
          
      IDF：逆文档频率，表征词语在文档间的普遍重要性，一定程度上对应于具体tag之间的相似度数据（文档间）
      
    ② BM25：
    
      待了解
      
  b) 标签数据本身的得分作为权重：专家的经验性、主观性打分
  
    能直接用最好
    
## Q&A:
1. 在用的ES版本支持哪些分词，如何指定特定分词方式（wiki只有默认标准分词器），输入字段怎么设计按label分词？

2. ES版本使用的是什么相关性匹配算法（TF-IDF/BM25）？

3. 能否达成：不同字段赋予不同权重，多个字段同时对相关性贡献权重？

4. Similarity的公式有多大程度上的定制能力，能否加入专家对item指定的权重（查询字段中的score），怎么做？

5. 需要提供一个接口做插入和查询的自测，索引文件的构建安排支撑。

6. 还有有哪些工程/性能上的注意点，需要评估在1200万的全量中相关性计算性能如何，并做压测。
